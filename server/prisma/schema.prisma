generator client {
    provider = "prisma-client-js"
    output   = "client"
}

datasource db {
    provider = "mongodb"
    url      = env("DATABASE_URL")
}

model User {
    id        String   @id @default(auto()) @map("_id") @db.ObjectId
    email     String   @unique
    name      String
    avatarUrl String?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    // Relations
    activityLogs ActivityLog[]

    @@map("users")
}

model ActivityLog {
    id             String   @id @default(auto()) @map("_id") @db.ObjectId
    userId         String   @db.ObjectId
    action         String
    collectionName String
    documentId     String   @db.ObjectId
    changeDiff     Json
    createdAt      DateTime @default(now())
    updatedAt      DateTime @updatedAt

    // Relations
    user User @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@index([userId])
    @@index([collectionName])
    @@map("activity_logs")
}
